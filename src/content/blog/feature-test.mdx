---
title: "Advanced Features Test - Math, Diagrams, and Code"
description: "A comprehensive test post showcasing mathematical equations, mermaid diagrams, and code syntax highlighting capabilities."
pubDate: 2025-01-16
author: "Xiaoyou Wu"
tags: ["test", "features", "math", "diagrams", "code"]
image: "/images/feature-test.jpg"
---

import Mermaid from "../../components/Mermaid.astro";

# Advanced Features Test

This blog post serves as a comprehensive test of the advanced features implemented in this Astro-based personal website, including mathematical equation rendering, mermaid diagrams, and code syntax highlighting.

## Mathematical Equations

Let's test the KaTeX mathematical rendering capabilities with various types of equations.

### Inline Mathematics

Here's an inline equation: $E = mc^2$, and another one: $\sum_{i=1}^{n} x_i = \bar{x} \cdot n$.

### Block Mathematics

Here's a more complex equation in display mode:

$$
\int_{-\infty}^{\infty} e^{-x^2} dx = \sqrt{\pi}
$$

### Engineering Mathematics

As a Computer Engineering student, here are some relevant equations:

**Fourier Transform:**
$$
F(\omega) = \int_{-\infty}^{\infty} f(t) e^{-j\omega t} dt
$$

**Digital Signal Processing (Z-Transform):**
$$
X(z) = \sum_{n=-\infty}^{\infty} x[n] z^{-n}
$$

**Control Systems (Transfer Function):**
$$
H(s) = \frac{Y(s)}{X(s)} = \frac{b_m s^m + b_{m-1} s^{m-1} + \cdots + b_1 s + b_0}{a_n s^n + a_{n-1} s^{n-1} + \cdots + a_1 s + a_0}
$$

**Matrix Operations (used in robotics):**
$$
\begin{bmatrix}
x' \\
y' \\
z' \\
1
\end{bmatrix}
=
\begin{bmatrix}
r_{11} & r_{12} & r_{13} & t_x \\
r_{21} & r_{22} & r_{23} & t_y \\
r_{31} & r_{32} & r_{33} & t_z \\
0 & 0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
x \\
y \\
z \\
1
\end{bmatrix}
$$

## Mermaid Diagrams

Now let's test mermaid diagram rendering with various types of diagrams.

### Flight Computer Architecture Flowchart

<Mermaid title="Flight Computer Architecture" code={`flowchart TD
    A[Sensor Input] --> B{Data Processing Unit}
    B --> C[Kalman Filter]
    B --> D[Navigation Algorithm]
    C --> E[State Estimation]
    D --> E
    E --> F[Flight Control]
    F --> G[Actuator Commands]
    F --> H[Telemetry Output]
    
    I[GPS Module] --> B
    J[IMU Sensors] --> B
    K[Barometric Sensor] --> B
    L[Magnetometer] --> B
    
    style A fill:#e1f5fe
    style G fill:#f3e5f5
    style H fill:#f3e5f5`} />

### Soft Robotics Control System

<Mermaid title="Soft Robotics Control System" code={`graph LR
    A[Human Input] --> B[Control Interface]
    B --> C[Trajectory Planning]
    C --> D[Inverse Kinematics]
    D --> E[Actuator Control]
    E --> F[Pneumatic System]
    F --> G[Soft Robot Arm]
    G --> H[End Effector]
    
    G --> I[Force Sensors]
    I --> J[Feedback Controller]
    J --> C
    
    style A fill:#ffebee
    style H fill:#e8f5e8
    style J fill:#fff3e0`} />

### Project Timeline

<Mermaid title="Engineering Project Timeline" code={`gantt
    title Engineering Project Timeline
    dateFormat  YYYY-MM-DD
    section Research
    Literature Review    :done, research, 2024-09-01, 2024-10-15
    Concept Development  :done, concept, 2024-10-01, 2024-11-01
    section Design
    System Architecture  :done, design1, 2024-10-15, 2024-12-01
    PCB Design          :done, design2, 2024-11-15, 2024-12-31
    section Implementation
    Prototype Build     :active, impl1, 2024-12-15, 2025-02-01
    Testing Phase       :impl2, 2025-01-15, 2025-03-01
    section Documentation
    Technical Report    :doc1, 2025-02-01, 2025-03-15
    Presentation Prep   :doc2, 2025-03-01, 2025-03-30`} />

### State Machine for Embedded System

<Mermaid title="Embedded System State Machine" code={`stateDiagram-v2
    [*] --> PowerOn
    PowerOn --> Initialization
    Initialization --> Standby: Init Complete
    Standby --> Operating: Start Command
    Operating --> Processing: Data Received
    Processing --> Operating: Processing Complete
    Operating --> Standby: Stop Command
    Operating --> Error: Fault Detected
    Error --> Standby: Reset
    Standby --> PowerOff: Shutdown
    PowerOff --> [*]`} />

## Code Syntax Highlighting

Let's test syntax highlighting for various programming languages used in engineering projects.

### C++ (Embedded Systems)

```cpp
#include <Arduino.h>
#include <Wire.h>
#include <SPI.h>

class FlightController {
private:
    float attitude[3];  // roll, pitch, yaw
    float position[3];  // x, y, z
    
public:
    void updateSensors() {
        // Read IMU data
        Wire.beginTransmission(0x68);  // MPU6050 address
        Wire.write(0x3B);              // Starting register
        Wire.endTransmission(false);
        Wire.requestFrom(0x68, 14, true);
        
        // Process accelerometer and gyroscope data
        int16_t accel_x = Wire.read() << 8 | Wire.read();
        int16_t accel_y = Wire.read() << 8 | Wire.read();
        int16_t accel_z = Wire.read() << 8 | Wire.read();
        
        // Apply Kalman filter for state estimation
        kalmanFilter(accel_x, accel_y, accel_z);
    }
    
    void kalmanFilter(float ax, float ay, float az) {
        // Implementation of Kalman filter algorithm
        static float Q_angle = 0.001f;
        static float Q_bias = 0.003f;
        static float R_measure = 0.03f;
        
        // Kalman filter calculations here...
    }
};
```

### Python (Data Analysis & ML)

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy import signal
from sklearn.ensemble import RandomForestRegressor

def analyze_sensor_data(raw_data):
    """
    Analyze sensor data for soft robotics application
    """
    # Apply low-pass filter to remove noise
    sos = signal.butter(4, 0.1, 'low', output='sos')
    filtered_data = signal.sosfilt(sos, raw_data)
    
    # Feature extraction for machine learning
    features = []
    for i in range(0, len(filtered_data) - 50, 10):
        window = filtered_data[i:i+50]
        feature_vector = [
            np.mean(window),
            np.std(window),
            np.max(window) - np.min(window),
            np.sum(np.diff(window) ** 2)  # Total variation
        ]
        features.append(feature_vector)
    
    return np.array(features)

# Train ML model for sensor fusion
def train_sensor_fusion_model(sensor_data, ground_truth):
    X = analyze_sensor_data(sensor_data)
    y = ground_truth
    
    model = RandomForestRegressor(n_estimators=100, random_state=42)
    model.fit(X, y)
    
    return model

# Visualization
plt.figure(figsize=(12, 6))
plt.subplot(2, 1, 1)
plt.plot(raw_data, label='Raw Sensor Data', alpha=0.7)
plt.plot(filtered_data, label='Filtered Data', linewidth=2)
plt.legend()
plt.title('Sensor Data Processing')

plt.subplot(2, 1, 2)
plt.plot(prediction, label='ML Prediction')
plt.plot(ground_truth, label='Ground Truth')
plt.legend()
plt.title('Machine Learning Results')
plt.tight_layout()
plt.show()
```

### JavaScript (Web Development)

```javascript
// Real-time data visualization for engineering dashboard
class SensorDashboard {
    constructor(containerId) {
        this.container = document.getElementById(containerId);
        this.data = [];
        this.chart = null;
        this.websocket = null;
        
        this.initializeChart();
        this.connectWebSocket();
    }
    
    initializeChart() {
        const config = {
            type: 'line',
            data: {
                labels: [],
                datasets: [{
                    label: 'Sensor Reading',
                    data: [],
                    borderColor: 'rgb(75, 192, 192)',
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    tension: 0.1
                }]
            },
            options: {
                responsive: true,
                animation: {
                    duration: 0 // Disable animation for real-time updates
                },
                scales: {
                    x: {
                        type: 'realtime',
                        realtime: {
                            duration: 20000,
                            refresh: 1000,
                            delay: 2000
                        }
                    }
                }
            }
        };
        
        this.chart = new Chart(this.container, config);
    }
    
    connectWebSocket() {
        this.websocket = new WebSocket('ws://localhost:8080/sensor-data');
        
        this.websocket.onmessage = (event) => {
            const sensorData = JSON.parse(event.data);
            this.updateChart(sensorData);
        };
        
        this.websocket.onerror = (error) => {
            console.error('WebSocket error:', error);
        };
    }
    
    updateChart(data) {
        const now = Date.now();
        this.chart.data.datasets[0].data.push({
            x: now,
            y: data.value
        });
        
        this.chart.update('none');
    }
}

// Initialize dashboard when page loads
document.addEventListener('DOMContentLoaded', () => {
    const dashboard = new SensorDashboard('sensor-chart');
});
```

### MATLAB (Signal Processing)

```matlab
function [filtered_signal, frequency_response] = process_flight_data(raw_data, fs)
    % Signal processing for flight computer data
    % fs: sampling frequency
    
    % Design Butterworth filter
    fc = 50; % Cutoff frequency (Hz)
    [b, a] = butter(4, fc/(fs/2), 'low');
    
    % Apply filter
    filtered_signal = filtfilt(b, a, raw_data);
    
    % Compute frequency response
    [H, f] = freqz(b, a, 1024, fs);
    frequency_response = struct('H', H, 'f', f);
    
    % Plot results
    figure;
    subplot(3, 1, 1);
    plot((1:length(raw_data))/fs, raw_data);
    title('Raw Flight Data');
    xlabel('Time (s)');
    ylabel('Amplitude');
    
    subplot(3, 1, 2);
    plot((1:length(filtered_signal))/fs, filtered_signal);
    title('Filtered Flight Data');
    xlabel('Time (s)');
    ylabel('Amplitude');
    
    subplot(3, 1, 3);
    semilogx(f, 20*log10(abs(H)));
    title('Filter Frequency Response');
    xlabel('Frequency (Hz)');
    ylabel('Magnitude (dB)');
    grid on;
end

% Example usage
fs = 1000; % 1 kHz sampling rate
t = 0:1/fs:10; % 10 seconds of data
raw_data = sin(2*pi*10*t) + 0.5*sin(2*pi*100*t) + 0.1*randn(size(t));

[filtered, freq_resp] = process_flight_data(raw_data, fs);
```

### Verilog (FPGA Development)

```verilog
module flight_computer_fpga (
    input wire clk,              // System clock
    input wire rst_n,            // Active low reset
    input wire [11:0] adc_data,  // 12-bit ADC data
    input wire adc_valid,        // ADC data valid signal
    output reg [15:0] processed_data,
    output reg data_ready
);

    // Internal registers
    reg [15:0] accumulator;
    reg [3:0] sample_count;
    reg [11:0] data_buffer [0:15]; // 16-sample circular buffer
    reg [3:0] buffer_index;
    
    // Moving average filter
    always @(posedge clk or negedge rst_n) begin
        if (!rst_n) begin
            accumulator <= 16'b0;
            sample_count <= 4'b0;
            buffer_index <= 4'b0;
            processed_data <= 16'b0;
            data_ready <= 1'b0;
        end else begin
            if (adc_valid) begin
                // Update circular buffer
                data_buffer[buffer_index] <= adc_data;
                
                // Update accumulator
                if (sample_count < 15) begin
                    accumulator <= accumulator + adc_data;
                    sample_count <= sample_count + 1;
                end else begin
                    // Subtract oldest sample and add new sample
                    accumulator <= accumulator - data_buffer[buffer_index] + adc_data;
                end
                
                // Update buffer index
                buffer_index <= (buffer_index == 15) ? 0 : buffer_index + 1;
                
                // Output averaged data
                if (sample_count == 15) begin
                    processed_data <= accumulator >> 4; // Divide by 16
                    data_ready <= 1'b1;
                end else begin
                    data_ready <= 1'b0;
                end
            end else begin
                data_ready <= 1'b0;
            end
        end
    end
    
endmodule

// Testbench
module tb_flight_computer_fpga;
    reg clk, rst_n, adc_valid;
    reg [11:0] adc_data;
    wire [15:0] processed_data;
    wire data_ready;
    
    // Instantiate module under test
    flight_computer_fpga uut (
        .clk(clk),
        .rst_n(rst_n),
        .adc_data(adc_data),
        .adc_valid(adc_valid),
        .processed_data(processed_data),
        .data_ready(data_ready)
    );
    
    // Clock generation
    initial begin
        clk = 0;
        forever #5 clk = ~clk;
    end
    
    // Test stimulus
    initial begin
        rst_n = 0;
        adc_valid = 0;
        adc_data = 0;
        
        #20 rst_n = 1;
        
        // Send test data
        repeat(20) begin
            #10 adc_data = $random % 4096;
            adc_valid = 1;
            #10 adc_valid = 0;
        end
        
        #100 $finish;
    end
    
endmodule
```

## Conclusion

This test post demonstrates the successful integration of:

1. **Mathematical Rendering**: KaTeX successfully renders both inline and display mathematics, including complex engineering equations
2. **Mermaid Diagrams**: Various diagram types work correctly with client-side rendering, including flowcharts, Gantt charts, and state diagrams
3. **Code Highlighting**: Syntax highlighting works for multiple programming languages commonly used in engineering

The website is now fully equipped to handle technical content with rich mathematical expressions, interactive mermaid diagrams, and well-formatted code examples - perfect for documenting engineering projects and research. 
